set(CMAKE_CONFIGURATION_TYPES "megaatmega2560" CACHE STRING "" FORCE)

set(PLATFORMIO_CMD "/usr/local/bin/pio")

SET(CMAKE_C_COMPILER "$ENV{HOME}/.platformio/packages/toolchain-atmelavr/bin/avr-gcc")
SET(CMAKE_CXX_COMPILER "$ENV{HOME}/.platformio/packages/toolchain-atmelavr/bin/avr-g++")
SET(CMAKE_CXX_FLAGS "-fno-exceptions -fno-threadsafe-statics -fpermissive -std=gnu++17 -Os -Wall -ffunction-sections -fdata-sections -flto -mmcu=atmega2560")
SET(CMAKE_C_FLAGS "-std=gnu11 -fno-fat-lto-objects -Os -Wall -ffunction-sections -fdata-sections -flto -mmcu=atmega2560")

SET(CMAKE_C_STANDARD 11)
set(CMAKE_CXX_STANDARD 17)

add_definitions(-D'PLATFORMIO=40201')
add_definitions(-D'ARDUINO_AVR_MEGA2560')
add_definitions(-D'F_CPU=16000000L')
add_definitions(-D'ARDUINO_ARCH_AVR')
add_definitions(-D'ARDUINO=10808')
add_definitions(-D'__AVR_ATmega2560__')

include_directories("$ENV{HOME}/.platformio/packages/framework-arduino-avr/cores/arduino")
include_directories("$ENV{HOME}/.platformio/packages/framework-arduino-avr/variants/mega")
include_directories("$ENV{HOME}/.platformio/packages/framework-arduino-avr/libraries/EEPROM/src")
include_directories("$ENV{HOME}/.platformio/packages/framework-arduino-avr/libraries/HID/src")
include_directories("$ENV{HOME}/.platformio/packages/framework-arduino-avr/libraries/SPI/src")
include_directories("$ENV{HOME}/.platformio/packages/framework-arduino-avr/libraries/SoftwareSerial/src")
include_directories("$ENV{HOME}/.platformio/packages/framework-arduino-avr/libraries/Wire/src")
include_directories("$ENV{HOME}/.platformio/packages/toolchain-atmelavr/avr/include")
include_directories("$ENV{HOME}/.platformio/packages/toolchain-atmelavr/lib/gcc/avr/5.4.0/include")
include_directories("$ENV{HOME}/.platformio/packages/toolchain-atmelavr/lib/gcc/avr/5.4.0/include-fixed")
include_directories("$ENV{HOME}/.platformio/packages/tool-unity")

FILE(GLOB_RECURSE SRC_LIST "${CMAKE_CURRENT_LIST_DIR}/Marlin/src/*.*" "${CMAKE_CURRENT_LIST_DIR}/Marlin/lib/*.*" "${CMAKE_CURRENT_LIST_DIR}/.pio/libdeps/megaatmega2560/*.*")
